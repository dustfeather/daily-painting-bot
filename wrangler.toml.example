name = "daily-painting-bot"
main = "src/index.ts"
compatibility_date = "2024-12-03"
compatibility_flags = ["nodejs_compat"]

# Cron trigger for daily delivery at 8:00 AM UTC
# Format: minute hour day month day-of-week
# Examples:
#   "0 8 * * *"     - Daily at 8:00 AM UTC
#   "0 6 * * *"     - Daily at 6:00 AM UTC
#   "0 12 * * 1-5"  - Weekdays at 12:00 PM UTC
[triggers]
crons = ["0 8 * * *"]

# D1 Database binding
# After creating the database with 'wrangler d1 create painting_bot_db',
# replace the placeholders below with actual values:
# - For local development: Copy this file to wrangler.toml and fill in your values
# - For GitHub Actions: These placeholders are replaced automatically from secrets
[[d1_databases]]
binding = "DB"
database_name = "{{DATABASE_NAME}}"
database_id = "{{DATABASE_ID}}"

# Environment variables (non-sensitive)
# These are safe to commit to version control
[vars]
PERPLEXITY_API_URL = "https://api.perplexity.ai"
PERPLEXITY_TEXT_MODEL = "llama-3.1-sonar-small-128k-online"
PERPLEXITY_IMAGE_MODEL = "playground-v2.5"
WHATSAPP_API_URL = "https://graph.facebook.com/v18.0"
MAX_RETRIES = "3"
RETRY_DELAY_MS = "1000"

# Secrets (NEVER commit these values)
# Set these using: wrangler secret put <SECRET_NAME>
# For local development, add these to .dev.vars (which is gitignored)
#
# Required secrets:
#   WHATSAPP_API_TOKEN        - WhatsApp Business API access token
#   WHATSAPP_PHONE_NUMBER_ID  - WhatsApp Business phone number ID
#   PERPLEXITY_API_KEY        - Perplexity AI API key
#   WEBHOOK_VERIFY_TOKEN      - Custom webhook verification token
#
# See DEPLOYMENT.md for detailed instructions on obtaining these credentials
